<!DOCTYPE html><html lang="ko" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션" /><meta name="author" content="jeonyoungho" /><meta property="og:locale" content="ko" /><meta name="description" content="본 포스팅은 인프러의 JPA 기본편을 수강하고 정리하는 내용입니다." /><meta property="og:description" content="본 포스팅은 인프러의 JPA 기본편을 수강하고 정리하는 내용입니다." /><link rel="canonical" href="https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/" /><meta property="og:url" content="https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/" /><meta property="og:site_name" content="Youngho’s Devlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-27T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션" /><meta name="twitter:site" content="@jeonyoungho_o" /><meta name="twitter:creator" content="@jeonyoungho" /><meta name="google-site-verification" content="eonGeSiIVfF48EnFoJqakC7h2hUzgqxFNJaxkfPiGr0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"jeonyoungho"},"dateModified":"2021-10-27T00:00:00+09:00","datePublished":"2021-10-27T00:00:00+09:00","description":"본 포스팅은 인프러의 JPA 기본편을 수강하고 정리하는 내용입니다.","headline":"[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션","mainEntityOfPage":{"@type":"WebPage","@id":"https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/"},"url":"https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/"}</script><title>[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션 | Youngho's Devlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Youngho's Devlog"><meta name="application-name" content="Youngho's Devlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-RF6ZGDWXV1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RF6ZGDWXV1'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5958719204143086" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/youngho_employee_pic.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Youngho's Devlog</a></div><div class="site-subtitle font-italic">curios developer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/jeonyoungho" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/jeonyoungho_o" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yhjun1000','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <ins class="adsbygoogle" style="display:block; margin-top: 30px;" data-ad-client="ca-pub-5958719204143086" data-ad-slot="1982371670" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> jeonyoungho </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Oct 27, 2021, 12:00 AM +0900" prep="on" > Oct 27, 2021 <i class="unloaded">2021-10-27T00:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2226 words">12 min</span></div></div><div class="post-content"><p>본 포스팅은 인프러의 <a href="https://www.inflearn.com/course/ORM-JPA-Basic#">JPA 기본편</a>을 수강하고 정리하는 내용입니다.</p><hr /><p><code class="language-plaintext highlighter-rouge">값 타입 컬렉션</code>은 값 타입을 컬렉션에 담아서 쓰는 것을 말한다. 문제는 DB에 넣을때가 문제가 된다. 기본적으로 값 타입 컬렉션을 DB에 넣는 구조를 지원하지 않는다. 결론적으로 이러한 컬렉션들을 별도의 테이블로 뽑아야한다. (FAVORITE_FOOD 테이블, ADDRESS 테이블)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/44339530/139053463-06c8bf50-bc21-4de7-830a-94cdaf35012e.png" alt="image" /></p><ul><li><b>값 타입을 하나 이상 저장할 때 사용</b><li><code class="language-plaintext highlighter-rouge">@ElementCollection</code>, <code class="language-plaintext highlighter-rouge">@CollectionTable</code> 사용<li>데이터베이스는 컬렉션을 같은 테이블에 저장할 수 없다.<ul><li>DB안에 한 테이블에 컬렉션을 넣을 수 있는 방법은 없다.</ul><li>일대다로 풀어서 컬렉션을 저장하기 위한 별도의 테이블이 필요함</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>@Entity
public class Member {

    @Id
    @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    // 기간 Period
    @Embedded
    private Period workPeriod;

    // 주소
    @Embedded
    private Address homeAddress;

    @ElementCollection
    @CollectionTable(name = "FAVORITE_FOOD", joinColumns =
        @JoinColumn(name = "MEMBER_ID")
    )
    @Column(name = "FOOD_NAME")
    private Set&lt;String&gt; favoriteFoods = new HashSet&lt;&gt;();

    @ElementCollection
    @CollectionTable(name = "ADDRESS", joinColumns =
        @JoinColumn(name = "MEMBER_ID")
    )
    private List&lt;Address&gt; addressHistory = new ArrayList&lt;&gt;();

    ...
}
</pre></table></code></div></div><h1 id="값-타입-컬렉션-사용">값 타입 컬렉션 사용</h1><p>1) 값 타입 저장 예제</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Member member = new Member();
member.setUsername("member1");
member.setHomeAddress(new Address("homeCity", "street", "1000"));
member.getFavoriteFoods().add("치킨");
member.getFavoriteFoods().add("피자");
member.getFavoriteFoods().add("족발");

member.getAddressHistory().add(new Address("old1", "street", "1000"));
member.getAddressHistory().add(new Address("old2", "street", "1000"));

em.persist(member);

tx.commit();
</pre></table></code></div></div><p>2) 값 타입 조회 예제</p><ul><li><b>값 타입 컬렉션도 지연 로딩 전략 사용</b><li><b>엔티티 테이블만 가져오고 값 타입 컬렉션은 프록시로 가져온다.</b><li>나중에 실제 값 타입 객체(FAVORITE_FOOD 테이블, ADDRESS 가 호출될때 select 쿼리를 호출한다)</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>Member member = new Member();
member.setUsername("member1");
member.setHomeAddress(new Address("homeCity", "street", "1000"));
member.getFavoriteFoods().add("치킨");
member.getFavoriteFoods().add("피자");
member.getFavoriteFoods().add("족발");

member.getAddressHistory().add(new Address("old1", "street", "1000"));
member.getAddressHistory().add(new Address("old2", "street", "1000"));

em.persist(member);

em.flush();
em.clear();

System.out.println("===== START =====");
Member findMember = em.find(Member.class, member.getId());
List&lt;Address&gt; addressHistory = findMember.getAddressHistory();
for(Address address : addressHistory) {
   System.out.println("address = " + address.getCity());
}

Set&lt;String&gt; favoriteFoods = findMember.getFavoriteFoods();
for (String favoriteFood : favoriteFoods) {
   System.out.println("favoriteFood = " + favoriteFood);
}

tx.commit();
</pre></table></code></div></div><p>3) 값 타입 수정 예제</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>Member member = new Member();
member.setUsername("member1");
member.setHomeAddress(new Address("homeCity", "street", "1000"));
member.getFavoriteFoods().add("치킨");
member.getFavoriteFoods().add("피자");
member.getFavoriteFoods().add("족발");

member.getAddressHistory().add(new Address("old1", "street", "1000"));
member.getAddressHistory().add(new Address("old2", "street", "1000"));

em.persist(member);

em.flush();
em.clear();

System.out.println("===== START =====");
Member findMember = em.find(Member.class, member.getId());

// homeCity =&gt; newCity
Address a = findMember.getHomeAddress();
findMember.setHomeAddress(new Address("newCity", a.getStreet(), a.getZipcode()));

// 치킨 -&gt; 한식 (String 자체가 값 타입이기에 제거하고 새로 추가해줘야함, 컬렉션의 값만 변경해도 JPA가 알아서 바꿔준다.)
findMember.getFavoriteFoods().remove("치킨");
findMember.getFavoriteFoods().add("한식");

// MEMBER_ID에 해당하는 값들을 전부 삭제하고 기존의 old2와 newCity1 두 개를 새로 insert수행한다.
// 마치 cascade에 고아 객체 제거 기능이 포함된 것처럼 동작한다.
findMember.getAddressHistory().remove(new Address("old1", "street", "1000")); // 내부에서 equals() 로 값을 찾아 삭제
findMember.getAddressHistory().add(new Address("newCity1", "street", "1000"));

tx.commit();
</pre></table></code></div></div><ul><li><b>참고: 값 타입 컬렉션은 영속성 전에(Cascade) + 고아 객체 제거 기능을 필수로 가진다고 볼 수 있다.</b><li>값 타입은 별도의 라이프 사이클을 가지지 않고 엔티티에 의존한다. 엔티티의 값을 바뀌거나 하면 자동으로 업데이트 된다. (일대다 연관관계에서 cascade all 넣고 orphan true로 넣은것이랑 같다고 보면 된다)</ul><h1 id="값-타입-컬렉션의-제약사항">값 타입 컬렉션의 제약사항</h1><ul><li>값 타입은 엔티티와 다르게 식별자 개념이 없다.<li>값은 변경하면 추적이 어렵다.<li><b>값 타입 컬렉션에 변경 사항이 발생하면, 주인 엔티티와 연관된 모든 데이터를 삭제하고, 값 타입 컬렉션에 있는 현재 값을 모두 다시 저장한다.</b><ul><li>값 타입 컬렉션에서 하나를 지우고 새로 하나를 추가한다면 기존에 있는 것들을 전부 삭제 기존의 남은 것들을 전부 insert쿼리로 추가한다.<li><code class="language-plaintext highlighter-rouge">@OrderColumn(name = "address_history_order")</code>을 사용하여 컬렉션 순서 값이 들어가서 해결할 수 있긴하다. 하지만 이것도 엄청 위험하다. 원하는대로 의도하지 동작하는 것도 되게 많고 컬렉션이 0, 1, 2, 3인데 중간에 2번을 빼먹으면 0, 1하고 2번이 null로 들어오기도 한다.<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>@OrderColumn(name = "address_history_order")
@ElementCollection
@CollectionTable(name = "ADDRESS", joinColumns =
    @JoinColumn(name = "MEMBER_ID")
)
private List&lt;Address&gt; addressHistory = new ArrayList&lt;&gt;();
</pre></table></code></div></div><li><b>결론적으로 이렇게 복잡하게 쓸거면 완전히 다르게 풀어야한다.</b></ul><li>값 타입 컬렉션을 매핑하는 테이블은 모든 컬럼을 묶어서 기본키를 구성해야 함: <code class="language-plaintext highlighter-rouge">null 입력X</code>, <code class="language-plaintext highlighter-rouge">중복 저장X</code></ul><h1 id="값-타입-컬렉션-대안">값 타입 컬렉션 대안</h1><ul><li>실무에서는 상황에 따라 <b>값 타입 컬렉션 대신에 일대다 관계를 고려</b><ul><li>값 타입을 엔티티로 승격한다</ul><li>일대다 관계를 위한 엔티티를 만들고, 여기에서 값 타입을 사용<li>영속성 전이(Cascade) + 고아 객체 제거를 사용해서 값 타입 컬렉션 처럼 사용<li>EX) AddressEntity</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
</pre><td class="rouge-code"><pre>@Embeddable
public class Address {
    private String city;
    private String street;
    private String zipcode;

    public Address() {
    }

    public Address(String city, String street, String zipcode) {
        this.city = city;
        this.street = street;
        this.zipcode = zipcode;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Address address = (Address) o;
        return Objects.equals(city, address.city) &amp;&amp;
                Objects.equals(street, address.street) &amp;&amp;
                Objects.equals(zipcode, address.zipcode);
    }

    @Override
    public int hashCode() {
        return Objects.hash(city, street, zipcode);
    }

    ...
}

@Entity
@Table(name = "ADDRESS")
public class AddressEntity {

    @Id
    @GeneratedValue
    private Long id;

    private Address address;

    public AddressEntity() {

    }

    public AddressEntity(String city, String street, String zipcode) {
        this.address = new Address(city, street, zipcode);
    }

    ...
}

@Entity
public class Member {

    @Id
    @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    // 기간 Period
    @Embedded
    private Period workPeriod;

    // 주소
    @Embedded
    private Address homeAddress;

    @ElementCollection
    @CollectionTable(name = "FAVORITE_FOOD", joinColumns =
        @JoinColumn(name = "MEMBER_ID")
    )
    @Column(name = "FOOD_NAME")
    private Set&lt;String&gt; favoriteFoods = new HashSet&lt;&gt;();

    @OneToMany(cascade = ALL, orphanRemoval = true)
    @JoinColumn(name = "MEMBER_ID")
    private List&lt;AddressEntity&gt; addressHistory = new ArrayList&lt;&gt;();
    
    ...
}

public class JpaMain {
    public static void main(String[] args) {
        ...

        try {

            Member member = new Member();
            member.setUsername("member1");
            member.setHomeAddress(new Address("homeCity", "street", "1000"));
            member.getFavoriteFoods().add("치킨");
            member.getFavoriteFoods().add("피자");
            member.getFavoriteFoods().add("족발");

            member.getAddressHistory().add(new AddressEntity("old1", "street", "1000"));
            member.getAddressHistory().add(new AddressEntity("old2", "street", "1000"));

            em.persist(member);

            em.flush();
            em.clear();

            System.out.println("===== START =====");
            Member findMember = em.find(Member.class, member.getId());

            // MEMBER_ID에 해당하는 값들을 전부 삭제하고 기존의 old2와 newCity1 두 개를 새로 insert수행한다.
            // 마치 cascade에 고아 객체 제거 기능이 포함된 것처럼 동작한다.
            findMember.getAddressHistory().remove(new AddressEntity("old1", "street", "1000")); // 내부에서 equals() 로 값을 찾아 삭제
            findMember.getAddressHistory().add(new AddressEntity("newCity1", "street", "1000"));

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
            e.printStackTrace();
        } finally {
            em.close();
        }

        emf.close();
    }

}
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/44339530/139171874-8d47e4d8-1bf7-4b92-9ccb-e8993b0bbe39.png" alt="image" /></p><h1 id="값-타입-컬렉션은-언제쓰는가">값 타입 컬렉션은 언제쓰는가?</h1><p>예를 들어, 셀렉트 박스에 치킨이나 피자를 멀티로(다중) 체크할 수 있다. 이렇게 추적할 필요가 없고 값이 바껴도 업데이트칠 필요가 없을때 값 타입컬렉션을 쓴다.</p><p>그게 아닌 이상은 왠만하면 엔티티다. 주소 이력도 엔티티다. 주소 이력만 조회할때 다 엔티티로 해야한다. 값을 변경하지 않는다 해도 DB쿼리 자체를 그쪽에서 시작해서 가져와야 하는 것들은 다 엔티티로 보면된다. 주소가 다 사라져도 이력이 남아야할때가 있을텐데 그럴때도 엔티티를 써야한다. 물론 정말 단순한건 값 타입을 써도 된다.</p><h1 id="정리">정리</h1><ul><li>엔티티 타입의 특징<ul><li>식별자O<li>생명 주기 관리<li>공유</ul><li>값 타입의 특징<ul><li>식별자X<li>생명 주기를 엔티티에 의존<li>공유하지 않는 것이 안전(복사해서 사용)<li>불변 객체로 만드는 것이 안전</ul></ul><p>값 타입은 정말 값 타입이라 판단될 때만 사용해야 한다.</p><p>엔티티와 값 타입을 혼동해서 엔티티를 값 타입으로 만들면 안된다. 식별자가 필요하고, 지속해서 값을 추적, 변경해야 한다면 그것은 값 타입이 아닌 엔티티다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/backend/'>Backend</a>, <a href='/categories/jpa/'>JPA</a>, <a href='/categories/%EC%9D%B8%ED%94%84%EB%9F%B0jpa-%EA%B8%B0%EB%B3%B8%ED%8E%B8/'>인프런JPA-기본편</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a> <a href="/tags/jpa/" class="post-tag no-text-decoration" >jpa</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션 - Youngho's Devlog&url=https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션 - Youngho's Devlog&u=https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입 컬렉션 - Youngho's Devlog&url=https://jeonyoungho.github.io/posts/28%EA%B0%92-%ED%83%80%EC%9E%85-%EC%BB%AC%EB%A0%89%EC%85%98/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5958719204143086" data-ad-slot="1982371670" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-5958719204143086" data-ad-slot="5918543412"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <script src="https://utteranc.es/client.js" repo="jeonyoungho/jeonyoungho.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Kafka-%EB%A9%94%EC%8B%9C%EC%A7%80-%EC%A0%84%EB%8B%AC-%EB%B3%B4%EC%9E%A5-%EB%B0%A9%EC%8B%9D/">Kafka 메시지 전달 보장 방식</a><li><a href="/posts/Transactional-Outbox-%ED%8C%A8%ED%84%B4/">Transactional Outbox 패턴</a><li><a href="/posts/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%9D%B8%EB%8D%B1%EC%8A%A4-%EC%A1%B0%EA%B0%81%ED%99%94/">데이터베이스 인덱스 조각화(Fragmentation)</a><li><a href="/posts/Kafka-DeadLetter-%EA%B4%80%EB%A6%AC/">Kafka DeadLetter 관리</a><li><a href="/posts/Redis-%ED%8A%B9%EC%A7%95/">Redis 특징</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/effectivejava/">effectivejava</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/es6/">es6</a> <a class="post-tag" href="/tags/velopert/">velopert</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/poiemaweb/">poiemaweb</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/1%EA%B0%95%EC%A2%8C-%EC%86%8C%EA%B0%9C/"><div class="card-body"> <span class="timeago small" > Oct 22, 2021 <i class="unloaded">2021-10-22T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[자바 ORM 표준 JPA 프로그래밍-기본편] 강좌 소개</h3><div class="text-muted small"><p> 본 포스팅은 인프러의 JPA 기본편을 수강하고 정리하는 내용입니다. JPA? - Java Persistance API Jdbc -&gt; MyBatis, JdbcTemplate -&gt; JPA 과거에는 JdbcTemplate이나 MyBatis를 통해 sql을 한땀한땀 작성하여 개발을 했으나 이는 개발 생산성이 뒤떨어진다. JPA를 사용하면 ...</p></div></div></a></div><div class="card"> <a href="/posts/2SQL-%EC%A4%91%EC%8B%AC%EC%A0%81%EC%9D%B8-%EA%B0%9C%EB%B0%9C%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90/"><div class="card-body"> <span class="timeago small" > Oct 22, 2021 <i class="unloaded">2021-10-22T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[자바 ORM 표준 JPA 프로그래밍-기본편] SQL 중심적인 개발의 문제점</h3><div class="text-muted small"><p> 본 포스팅은 인프러의 JPA 기본편을 수강하고 정리하는 내용입니다. 대부분의 기업들은 객체 지향 언어(java, scala)를 사용한다. 또한 DB로는 관계형 DB를 많이 사용하고 있다. 그래서 지금 시대는 객체를 관계형 DB에 관리하는 시대이다. 문제는 애플리케이션은 객체 지향 개발하면서 하는데 딱 코드를 까보면 SQL만 천지이다. 결국엔 ...</p></div></div></a></div><div class="card"> <a href="/posts/3JPA-%EC%86%8C%EA%B0%9C/"><div class="card-body"> <span class="timeago small" > Oct 25, 2021 <i class="unloaded">2021-10-25T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[자바 ORM 표준 JPA 프로그래밍-기본편] JPA 소개</h3><div class="text-muted small"><p> 본 포스팅은 인프러의 JPA 기본편을 수강하고 정리하는 내용입니다. JPA란? Java Persistence API의 준말 자바 진영의 ORM 기술 표준 ORM이란? Object-relational mapping(객체 관계 매핑) 객체는 객체대로 설계 관계형 데이터베이스는 관계형 데이터베이스대로 설...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/27%EA%B0%92-%ED%83%80%EC%9E%85%EC%9D%98-%EB%B9%84%EA%B5%90/" class="btn btn-outline-primary" prompt="Older"><p>[자바 ORM 표준 JPA 프로그래밍-기본편] 값 타입의 비교</p></a> <a href="/posts/29%EC%8B%A4%EC%A0%84-%EC%98%88%EC%A0%9C6-%EA%B0%92-%ED%83%80%EC%9E%85-%EB%A7%A4%ED%95%91/" class="btn btn-outline-primary" prompt="Newer"><p>[자바 ORM 표준 JPA 프로그래밍-기본편] 실전 예제6 - 값 타입 매핑</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/jeonyoungho_o">jeonyoungho</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/effectivejava/">effectivejava</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/es6/">es6</a> <a class="post-tag" href="/tags/velopert/">velopert</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/poiemaweb/">poiemaweb</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://jeonyoungho.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
