---
title: "[이펙티브자바] 아이템31-한정적 와일드카드를 사용해 API 유연성을 높이라"
# post의 layout이 기본적으로 post으로 설정되어있어서 Front Matter에 따로 layout변수를 만들어 주지 않아도 된다.
date: 2022-08-22 +0800
categories: [Java, EffectiveJava] # categories는 최대 2개까지 가능
tags: [java, effectivejava] # TAG는 반드시 소문자로 이루어져야함, 0~무한개까지 지정 가능
# pin: true # 홈페이지 메인화면에 특정 게시물 고정
toc: true # Table Of Content(TOC) 옵션, 기본적으로 포스트의 오른쪽 패널에 위치
comments: true # 댓글 유무 지정
---

- 이전 아이템28에서 이야기했듯 매개변수화 타입은 `불공변(invariant)`이다. 이를 꼭 기억하자.
  - 즉 서로 다른 타입 `Type1`과 `Type2`가 있을 때 `List<Type1>`은 `List<Type2>`의 하위 타입도 상위 타입도 아니다.
  - 예를 들어 `List<Object>`에는 어떤 객체든 넣을 수 있지만 `List<String>`에는 문자열만 넣을 수 있다. 즉, `List<String>`은 `List<Object>`가 하는 일을 제대로 수행하지 못하니 하위 타입이 될 수 없다(리스코프 치환 원칙에 어긋난다. 아이템10 참조)
- 이전에 언급되었던 Stack 예제에서 일련의 원소를 스택에 넣는 public API(pushAll 메서드)를 추가한다고 해보자.

```java
public class Stack<E> {
    public Stack();
    public void push(E e);
    public E pop();
    public boolean isEmpty();

    public void pushAll(Iteable<E> src) {
        for (E e : src) {
            push(e);
        }
    }
}
```

- 이 메서드는 깨끗이 컴파일되지만 완벽하진 않다. Iterable의 src의 원소 타입이 스택과 일치하면 잘 동작한다. 
- 하지만 `Stack<Number>`로 선언한 후 `pushAll(intVal)`을 호출하면 어떻게 될까? 여기서 intVal은 Integer 타입이다.
- Integeer는 Number의 하위 타입이니 잘 동작할 것이라 예상이 된다.

![image](https://user-images.githubusercontent.com/44339530/185819469-a698c746-1558-4394-bbd4-e190cb7638fa.png)

```java
Stack<Number> numberStack = new Stack<>();
Iterable<Integer> integers = Arrays.asList(3, 1, 4, 1, 5, 9);
numberStack.pushAll(integers);
```

- <b>하지만 실제 오류가 발생한다. 매개변수화 타입이 불공변이기 때문이다.</b>

```
StackTest.java:7: error: incompatible types: Iterable
cannot be converted to Iterable<Number>
Stack.pushAll(integers);
⌃
```

- 다행히 해결책은 있다. 자바는 이런 상황에 대처할 수 있는 `한정적 와일드카드 타입`이라는 특별한 매개변수화 타입을 지원한다.
- `pushAll`의 입력 매개변수 타입은 <b>E의 Iteralbe이 아니라 E의 하위 타입의 Iterable이어야 하며, 와일드 카드 타입 Iterable<? extends E>가 정확히 이런 뜻이다.</b>
- 이를 와일드카드 타입을 사용하도록 puahAll 메서드를 수정하면 아래와 같다.

```java
// 코드 31-2 E 생산자(producer) 매개변수에 와일드카드 타입 적용 (182쪽)
public void pushAll(Iterable<? extends E> src) {
    for (E e : src) {
        push(e);
    }
}
```


#### 참고 및 추러
- [https://micropilot.tistory.com/3055](https://micropilot.tistory.com/3055)